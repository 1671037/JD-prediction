/*
* @Author: han.jiang
* @Date:   2017-04-28 21:38:44
* @Last Modified by:   han.jiang
* @Last Modified time: 2017-05-09 11:48:15
*/

SELECT COUNT() FROM JDATA_USER_TBL;
-- 105321
SELECT COUNT() FROM JDATA_PRODUCT_TBL;
-- 24187
SELECT COUNT() FROM JDATA_COMMENT_TBL;
-- 558552
SELECT COUNT() FROM JDATA_ACTION_TBL;
-- 50601736

-- cate/brand buy time distribution
drop table if exists cate_buy_time_dist;
create table cate_buy_time_dist as
select
CATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS TIME_02_08_TYPE_4_COUNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' )) THEN 1 ELSE 0 END) AS TIME_09_12_TYPE_4_COUNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' )) THEN 1 ELSE 0 END) AS TIME_13_18_TYPE_4_COUNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS TIME_19_01_TYPE_4_COUNT
from JDATA_ACTION_TBL
group by CATE;

-- target generation
drop table if exists LABEL_0411_0415;
create table LABEL_0411_0415 as
select
USER_ID,
SKU_ID,
MAX(case when type = 4 then 1 else 0 end) as Y
from (
select *
from JDATA_ACTION_TBL
where 1=1
and time >= date('2016-04-11')
and time <  date('2016-04-16')
and CATE = '8'
)
group by
USER_ID,
SKU_ID;

SELECT COUNT() FROM LABEL_0411_0415 group by Y;
-- 1385 Y=1, 166021 Y=0


-- SKU level action signals
drop table if exists SKU_ACTION_0201_0410;
create table SKU_ACTION_0201_0410 as
select
SKU_ID
,SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS SKU_TYPE_1_CNT
,SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS SKU_TYPE_2_CNT
,SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS SKU_TYPE_3_CNT
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS SKU_TYPE_4_CNT
,SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS SKU_TYPE_5_CNT
,SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS SKU_TYPE_6_CNT
,SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_1_RATE
,SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_2_RATE
,SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_3_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_4_RATE
,SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_5_RATE
,SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_6_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS SKU_TYPE_1_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS SKU_TYPE_2_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS SKU_TYPE_3_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS SKU_TYPE_5_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS SKU_TYPE_6_4_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_RATE


,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_1_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_2_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_3_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_4_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_5_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_6_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_1_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_2_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_3_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_4_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_5_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_6_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS SKU_TYPE_1_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS SKU_TYPE_2_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS SKU_TYPE_3_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS SKU_TYPE_5_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS SKU_TYPE_6_4_RATE_3

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_RATE_3

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_1_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_2_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_3_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_4_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_5_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_6_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_1_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_2_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_3_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_4_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_5_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_6_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS SKU_TYPE_1_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS SKU_TYPE_2_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS SKU_TYPE_3_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS SKU_TYPE_5_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS SKU_TYPE_6_4_RATE_7

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_RATE_7

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_1_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_2_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_3_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_4_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_5_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_6_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_1_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_2_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_3_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_4_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_5_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_6_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS SKU_TYPE_1_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS SKU_TYPE_2_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS SKU_TYPE_3_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS SKU_TYPE_5_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS SKU_TYPE_6_4_RATE_15

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_RATE_15

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_1_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_2_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_3_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_4_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_5_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_6_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_1_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_2_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_3_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_4_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_5_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_6_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS SKU_TYPE_1_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS SKU_TYPE_2_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS SKU_TYPE_3_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS SKU_TYPE_5_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS SKU_TYPE_6_4_RATE_30

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_RATE_30

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_1_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_2_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_3_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_4_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_5_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_6_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_1_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_2_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_3_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_4_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_5_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_6_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS SKU_TYPE_1_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS SKU_TYPE_2_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS SKU_TYPE_3_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS SKU_TYPE_5_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS SKU_TYPE_6_4_RATE_45

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_RATE_45

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_1_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_2_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_3_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_4_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_5_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_6_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_1_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_2_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_3_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_4_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_5_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_TYPE_6_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS SKU_TYPE_1_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS SKU_TYPE_2_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS SKU_TYPE_3_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS SKU_TYPE_5_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS SKU_TYPE_6_4_RATE_60

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_1_02_08_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_1_09_12_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_1_13_18_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_1_19_01_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_2_02_08_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_2_09_12_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_2_13_18_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_2_19_01_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_3_02_08_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_3_09_12_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_3_13_18_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_3_19_01_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_4_02_08_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_4_09_12_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_4_13_18_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_4_19_01_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_5_02_08_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_5_09_12_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_5_13_18_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_5_19_01_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_6_02_08_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_6_09_12_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_6_13_18_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS SKU_TYPE_6_19_01_RATE_60

,COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS SKU_TYPE_1_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS SKU_TYPE_2_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS SKU_TYPE_3_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS SKU_TYPE_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS SKU_TYPE_5_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS SKU_TYPE_6_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_4_USER_RATE

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_4_USER_RATE_3

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_4_USER_RATE_7

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_4_USER_RATE_15

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_4_USER_RATE_30

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_4_USER_RATE_45

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_1_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_2_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_3_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_5_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS SKU_TYPE_6_4_USER_RATE_60

from JDATA_ACTION_TBL
where time <= DATE('2016-04-10')
group by SKU_ID;

select count() from SKU_ACTION_0201_0410;
-- 27907

-- Brand level action signals
drop table if exists BRAND_ACTION_0201_0410;
create table BRAND_ACTION_0201_0410 as
select
BRAND
,SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS BRAND_TYPE_1_CNT
,SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS BRAND_TYPE_2_CNT
,SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS BRAND_TYPE_3_CNT
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BRAND_TYPE_4_CNT
,SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS BRAND_TYPE_5_CNT
,SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS BRAND_TYPE_6_CNT
,SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_1_RATE
,SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_2_RATE
,SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_3_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_4_RATE
,SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_5_RATE
,SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_6_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS BRAND_TYPE_1_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS BRAND_TYPE_2_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS BRAND_TYPE_3_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS BRAND_TYPE_5_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS BRAND_TYPE_6_4_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_RATE


,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_1_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_2_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_3_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_4_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_5_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_6_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_4_RATE_3

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_RATE_3

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_1_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_2_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_3_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_4_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_5_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_6_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_4_RATE_7

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_RATE_7

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_1_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_2_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_3_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_4_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_5_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_6_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_4_RATE_15

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_RATE_15

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_1_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_2_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_3_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_4_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_5_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_6_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_4_RATE_30

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_RATE_30

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_1_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_2_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_3_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_4_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_5_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_6_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_4_RATE_45

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_RATE_45

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_1_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_2_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_3_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_4_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_5_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_TYPE_6_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_4_RATE_60

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_02_08_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_09_12_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_13_18_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_1_19_01_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_02_08_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_09_12_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_13_18_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_2_19_01_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_02_08_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_09_12_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_13_18_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_3_19_01_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_02_08_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_09_12_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_13_18_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_4_19_01_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_02_08_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_09_12_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_13_18_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_5_19_01_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_02_08_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_09_12_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_13_18_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS BRAND_TYPE_6_19_01_RATE_60

,COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS BRAND_TYPE_1_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS BRAND_TYPE_2_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS BRAND_TYPE_3_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS BRAND_TYPE_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS BRAND_TYPE_5_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS BRAND_TYPE_6_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_4_USER_RATE

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_4_USER_RATE_3

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_4_USER_RATE_7

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_4_USER_RATE_15

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_4_USER_RATE_30

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_4_USER_RATE_45

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_1_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_2_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_3_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_5_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS BRAND_TYPE_6_4_USER_RATE_60

from JDATA_ACTION_TBL
where time <= DATE('2016-04-10')
group by BRAND;

select count() from BRAND_ACTION_0201_0410;
-- 434

drop table if exists CATE_ACTION_0201_0410;
-- Cate level action signal
drop table if exists CATE_ACTION_0201_0410;
create table CATE_ACTION_0201_0410 as
select
CATE
,SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS CATE_TYPE_1_CNT
,SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS CATE_TYPE_2_CNT
,SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS CATE_TYPE_3_CNT
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS CATE_TYPE_4_CNT
,SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS CATE_TYPE_5_CNT
,SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS CATE_TYPE_6_CNT
,SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_1_RATE
,SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_2_RATE
,SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_3_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_4_RATE
,SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_5_RATE
,SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_6_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS CATE_TYPE_1_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS CATE_TYPE_2_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS CATE_TYPE_3_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS CATE_TYPE_5_4_RATE
,SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS CATE_TYPE_6_4_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_CNT
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_CNT
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_CNT
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_CNT
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_CNT
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_CNT
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_RATE
,SUM(CASE WHEN TYPE = "1" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_RATE
,SUM(CASE WHEN TYPE = "2" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_RATE
,SUM(CASE WHEN TYPE = "3" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_RATE
,SUM(CASE WHEN TYPE = "4" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_RATE
,SUM(CASE WHEN TYPE = "5" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_RATE
,SUM(CASE WHEN TYPE = "6" AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_RATE


,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_1_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_2_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_3_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_4_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_5_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_6_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_1_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_2_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_3_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_4_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_5_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_6_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS CATE_TYPE_1_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS CATE_TYPE_2_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS CATE_TYPE_3_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS CATE_TYPE_5_4_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=3) THEN 1 ELSE 0 END) AS CATE_TYPE_6_4_RATE_3

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_CNT_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_CNT_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_CNT_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_CNT_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_CNT_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_CNT_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_RATE_3
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_RATE_3
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_RATE_3
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_RATE_3
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_RATE_3
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_RATE_3
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_RATE_3

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_1_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_2_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_3_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_4_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_5_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_6_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_1_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_2_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_3_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_4_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_5_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_6_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS CATE_TYPE_1_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS CATE_TYPE_2_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS CATE_TYPE_3_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS CATE_TYPE_5_4_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=7) THEN 1 ELSE 0 END) AS CATE_TYPE_6_4_RATE_7

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_CNT_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_CNT_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_CNT_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_CNT_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_CNT_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_CNT_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_RATE_7
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_RATE_7
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_RATE_7
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_RATE_7
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_RATE_7
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_RATE_7
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_RATE_7

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_1_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_2_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_3_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_4_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_5_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_6_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_1_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_2_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_3_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_4_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_5_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_6_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS CATE_TYPE_1_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS CATE_TYPE_2_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS CATE_TYPE_3_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS CATE_TYPE_5_4_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=15) THEN 1 ELSE 0 END) AS CATE_TYPE_6_4_RATE_15

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_CNT_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_CNT_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_CNT_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_CNT_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_CNT_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_CNT_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_RATE_15
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_RATE_15
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_RATE_15
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_RATE_15
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_RATE_15
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_RATE_15
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_RATE_15

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_1_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_2_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_3_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_4_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_5_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_6_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_1_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_2_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_3_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_4_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_5_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_6_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS CATE_TYPE_1_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS CATE_TYPE_2_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS CATE_TYPE_3_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS CATE_TYPE_5_4_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=30) THEN 1 ELSE 0 END) AS CATE_TYPE_6_4_RATE_30

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_CNT_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_CNT_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_CNT_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_CNT_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_CNT_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_CNT_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_RATE_30
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_RATE_30
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_RATE_30
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_RATE_30
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_RATE_30
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_RATE_30
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_RATE_30

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_1_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_2_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_3_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_4_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_5_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_6_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_1_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_2_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_3_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_4_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_5_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_6_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS CATE_TYPE_1_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS CATE_TYPE_2_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS CATE_TYPE_3_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS CATE_TYPE_5_4_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=45) THEN 1 ELSE 0 END) AS CATE_TYPE_6_4_RATE_45

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_CNT_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_CNT_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_CNT_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_CNT_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_CNT_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_CNT_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_RATE_45
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_RATE_45
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_RATE_45
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_RATE_45
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_RATE_45
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_RATE_45
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_RATE_45

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_1_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_2_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_3_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_4_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_5_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_6_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_1_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_2_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_3_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_4_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_5_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_TYPE_6_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS CATE_TYPE_1_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS CATE_TYPE_2_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS CATE_TYPE_3_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS CATE_TYPE_5_4_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <=60) THEN 1 ELSE 0 END) AS CATE_TYPE_6_4_RATE_60

,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_CNT_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_CNT_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_CNT_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_CNT_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_CNT_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_CNT_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_1_02_08_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_1_09_12_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_1_13_18_RATE_60
,SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_1_19_01_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_2_02_08_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_2_09_12_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_2_13_18_RATE_60
,SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_2_19_01_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_3_02_08_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_3_09_12_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_3_13_18_RATE_60
,SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_3_19_01_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_4_02_08_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_4_09_12_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_4_13_18_RATE_60
,SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_4_19_01_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_5_02_08_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_5_09_12_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_5_13_18_RATE_60
,SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_5_19_01_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_6_02_08_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('09', '10', '11', '12' ))                   THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_6_09_12_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ))       THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_6_13_18_RATE_60
,SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) AND (STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' )) THEN 1 ELSE 0 END)*1.0 / SUM(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN 1 ELSE 0 END) AS CATE_TYPE_6_19_01_RATE_60

,COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_COUNT
,COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS CATE_TYPE_1_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS CATE_TYPE_2_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS CATE_TYPE_3_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS CATE_TYPE_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS CATE_TYPE_5_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(USER_ID)) AS CATE_TYPE_6_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_4_USER_RATE
,COUNT(DISTINCT(CASE WHEN TYPE = "4" THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_4_USER_RATE

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_COUNT_3
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_4_USER_RATE_3
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 3) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_4_USER_RATE_3

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_COUNT_7
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_4_USER_RATE_7
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 7) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_4_USER_RATE_7

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_COUNT_15
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_4_USER_RATE_15
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 15) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_4_USER_RATE_15

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_COUNT_30
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_4_USER_RATE_30
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 30) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_4_USER_RATE_30

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_COUNT_45
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_4_USER_RATE_45
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 45) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_4_USER_RATE_45

,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_COUNT_60
,COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "1" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_1_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "2" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_2_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "3" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_3_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "5" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_5_4_USER_RATE_60
,COUNT(DISTINCT(CASE WHEN TYPE = "4" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN TYPE = "6" AND (JULIANDAY('2016-04-10') - JULIANDAY(TIME) <= 60) THEN USER_ID ELSE NULL END)) AS CATE_TYPE_6_4_USER_RATE_60

from JDATA_ACTION_TBL
where time <= DATE('2016-04-10')
group by CATE;

select count() from CATE_ACTION_0201_0410;
-- 8

-- sku level rank and percentile
drop table if exists SKU_RANK_0201_0410;
create table SKU_RANK_0201_0410 as
select
A.*
,B.*
,SKU_TYPE_1_CNT*1.0/SKU_TYPE_1_CNT_MAX as SKU_TYPE_1_CNT_RANK
,SKU_TYPE_2_CNT*1.0/SKU_TYPE_2_CNT_MAX as SKU_TYPE_2_CNT_RANK
,SKU_TYPE_3_CNT*1.0/SKU_TYPE_3_CNT_MAX as SKU_TYPE_3_CNT_RANK
,SKU_TYPE_4_CNT*1.0/SKU_TYPE_4_CNT_MAX as SKU_TYPE_4_CNT_RANK
,SKU_TYPE_5_CNT*1.0/SKU_TYPE_5_CNT_MAX as SKU_TYPE_5_CNT_RANK
,SKU_TYPE_6_CNT*1.0/SKU_TYPE_6_CNT_MAX as SKU_TYPE_6_CNT_RANK
,SKU_TYPE_1_RATE*1.0/SKU_TYPE_1_RATE_MAX as SKU_TYPE_1_RATE_RANK
,SKU_TYPE_2_RATE*1.0/SKU_TYPE_2_RATE_MAX as SKU_TYPE_2_RATE_RANK
,SKU_TYPE_3_RATE*1.0/SKU_TYPE_3_RATE_MAX as SKU_TYPE_3_RATE_RANK
,SKU_TYPE_4_RATE*1.0/SKU_TYPE_4_RATE_MAX as SKU_TYPE_4_RATE_RANK
,SKU_TYPE_5_RATE*1.0/SKU_TYPE_5_RATE_MAX as SKU_TYPE_5_RATE_RANK
,SKU_TYPE_6_RATE*1.0/SKU_TYPE_6_RATE_MAX as SKU_TYPE_6_RATE_RANK
,SKU_TYPE_1_4_RATE*1.0/SKU_TYPE_1_4_RATE_MAX as SKU_TYPE_1_4_RATE_RANK
,SKU_TYPE_2_4_RATE*1.0/SKU_TYPE_2_4_RATE_MAX as SKU_TYPE_2_4_RATE_RANK
,SKU_TYPE_3_4_RATE*1.0/SKU_TYPE_3_4_RATE_MAX as SKU_TYPE_3_4_RATE_RANK
,SKU_TYPE_5_4_RATE*1.0/SKU_TYPE_5_4_RATE_MAX as SKU_TYPE_5_4_RATE_RANK
,SKU_TYPE_6_4_RATE*1.0/SKU_TYPE_6_4_RATE_MAX as SKU_TYPE_6_4_RATE_RANK
from
(select
*,
1 as join_key
from
SKU_ACTION_0201_0410
) as A
left join
(
select
1 as join_key
,MAX(SKU_TYPE_1_CNT) as SKU_TYPE_1_CNT_MAX
,MAX(SKU_TYPE_2_CNT) as SKU_TYPE_2_CNT_MAX
,MAX(SKU_TYPE_3_CNT) as SKU_TYPE_3_CNT_MAX
,MAX(SKU_TYPE_4_CNT) as SKU_TYPE_4_CNT_MAX
,MAX(SKU_TYPE_5_CNT) as SKU_TYPE_5_CNT_MAX
,MAX(SKU_TYPE_6_CNT) as SKU_TYPE_6_CNT_MAX
,MAX(SKU_TYPE_1_RATE) as SKU_TYPE_1_RATE_MAX
,MAX(SKU_TYPE_2_RATE) as SKU_TYPE_2_RATE_MAX
,MAX(SKU_TYPE_3_RATE) as SKU_TYPE_3_RATE_MAX
,MAX(SKU_TYPE_4_RATE) as SKU_TYPE_4_RATE_MAX
,MAX(SKU_TYPE_5_RATE) as SKU_TYPE_5_RATE_MAX
,MAX(SKU_TYPE_6_RATE) as SKU_TYPE_6_RATE_MAX
,MAX(SKU_TYPE_1_4_RATE) AS SKU_TYPE_1_4_RATE_MAX
,MAX(SKU_TYPE_2_4_RATE) AS SKU_TYPE_2_4_RATE_MAX
,MAX(SKU_TYPE_3_4_RATE) AS SKU_TYPE_3_4_RATE_MAX
,MAX(SKU_TYPE_5_4_RATE) AS SKU_TYPE_4_4_RATE_MAX
,MAX(SKU_TYPE_6_4_RATE) AS SKU_TYPE_6_4_RATE_MAX
from
SKU_ACTION_0201_0410
) as B
on A.join_key = B.join_key;

select count() from SKU_RANK_0201_0410;
-- 27907

-- brand level rank and percentile

select count() from BRAND_RANK_0201_0410;
-- 434

-- cate level rank and percentile

select count() from CATE_RANK_0201_0410;
-- 8

-- sku level comments
drop table if exists SKU_COMMENT_0201_0410;
create table SKU_COMMENT_0201_0410 as
select
SKU_ID
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 7)  THEN COMMENT_NUM ELSE NULL END) AS SKU_COMMENT_NUM_WK0
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 14) THEN COMMENT_NUM ELSE NULL END) AS SKU_COMMENT_NUM_WK1
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 21) THEN COMMENT_NUM ELSE NULL END) AS SKU_COMMENT_NUM_WK2
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 28) THEN COMMENT_NUM ELSE NULL END) AS SKU_COMMENT_NUM_WK3
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 35) THEN COMMENT_NUM ELSE NULL END) AS SKU_COMMENT_NUM_WK4
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 7)  THEN HAS_BAD_COMMENT ELSE NULL END) AS SKU_HAS_BAD_COMMENT_WK0
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 14) THEN HAS_BAD_COMMENT ELSE NULL END) AS SKU_HAS_BAD_COMMENT_WK1
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 21) THEN HAS_BAD_COMMENT ELSE NULL END) AS SKU_HAS_BAD_COMMENT_WK2
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 28) THEN HAS_BAD_COMMENT ELSE NULL END) AS SKU_HAS_BAD_COMMENT_WK3
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 35) THEN HAS_BAD_COMMENT ELSE NULL END) AS SKU_HAS_BAD_COMMENT_WK4
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 7)  THEN BAD_COMMENT_RATE ELSE NULL END) AS SKU_BAD_COMMENT_RATE_WK0
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 14) THEN BAD_COMMENT_RATE ELSE NULL END) AS SKU_BAD_COMMENT_RATE_WK1
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 21) THEN BAD_COMMENT_RATE ELSE NULL END) AS SKU_BAD_COMMENT_RATE_WK2
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 28) THEN BAD_COMMENT_RATE ELSE NULL END) AS SKU_BAD_COMMENT_RATE_WK3
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 35) THEN BAD_COMMENT_RATE ELSE NULL END) AS SKU_BAD_COMMENT_RATE_WK4
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 7)  THEN BAD_COMMENT_RATE ELSE NULL END) * MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 7)  THEN COMMENT_NUM ELSE NULL END) AS SKU_BAD_COMMENT_NUM_WK0
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 14) THEN BAD_COMMENT_RATE ELSE NULL END) * MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 14) THEN COMMENT_NUM ELSE NULL END) AS SKU_BAD_COMMENT_NUM_WK1
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 21) THEN BAD_COMMENT_RATE ELSE NULL END) * MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 21) THEN COMMENT_NUM ELSE NULL END) AS SKU_BAD_COMMENT_NUM_WK2
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 28) THEN BAD_COMMENT_RATE ELSE NULL END) * MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 28) THEN COMMENT_NUM ELSE NULL END) AS SKU_BAD_COMMENT_NUM_WK3
,MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 35) THEN BAD_COMMENT_RATE ELSE NULL END) * MAX(CASE WHEN (JULIANDAY('2016-04-10') - JULIANDAY(DT) <= 35) THEN COMMENT_NUM ELSE NULL END) AS SKU_BAD_COMMENT_NUM_WK4
from
JDATA_COMMENT_TBL
where DT <= DATE('2016-04-10')
group by SKU_ID;

select count() from SKU_COMMENT_0201_0410;
-- 46546

-- brand/cate comments

-- sku re-purchase rate
drop table if exists SKU_REPURCHASE_RATE_0201_0410;
create table SKU_REPURCHASE_RATE_0201_0410 as
select
SKU_ID
,SUM(CASE WHEN BUY_NUM >1 THEN 1 ELSE 0 END)*1.0 / COUNT() AS SKU_REPURCHASE_RATE
from (
select
SKU_ID,
USER_ID,
SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BUY_NUM
from
JDATA_ACTION_TBL
where TIME <= DATE('2016-04-10')
group by SKU_ID, USER_ID
)
group by SKU_ID;

select count() from SKU_REPURCHASE_RATE_0201_0410;
-- 27907
select count() from SKU_REPURCHASE_RATE_0201_0410 where SKU_REPURCHASE_RATE > 0;
-- 546

-- brand re-purchase rate
drop table if exists BRAND_REPURCHASE_RATE_0201_0410;
create table BRAND_REPURCHASE_RATE_0201_0410 as
select
BRAND
,SUM(CASE WHEN BUY_NUM >1 THEN 1 ELSE 0 END)*1.0 / COUNT() AS BRAND_REPURCHASE_RATE
from (
select
BRAND,
USER_ID,
SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BUY_NUM
from
JDATA_ACTION_TBL
where TIME <= DATE('2016-04-10')
group by BRAND, USER_ID
)
group by BRAND;

select count() from BRAND_REPURCHASE_RATE_0201_0410;
-- 434

select count() from BRAND_REPURCHASE_RATE_0201_0410 where BRAND_REPURCHASE_RATE > 0;
-- 135

-- cate re-purchase rate
drop table if exists CATE_REPURCHASE_RATE_0201_0410;
create table CATE_REPURCHASE_RATE_0201_0410 as
select
CATE
,SUM(CASE WHEN BUY_NUM >1 THEN 1 ELSE 0 END)*1.0 / COUNT() AS CATE_REPURCHASE_RATE
from (
select
CATE,
USER_ID,
SUM(CASE WHEN TYPE = "4" THEN 1 ELSE 0 END) AS BUY_NUM
from
JDATA_ACTION_TBL
where TIME <= DATE('2016-04-10')
group by CATE, USER_ID
)
group by CATE;

select count() from CATE_REPURCHASE_RATE_0201_0410;
-- 8
select count() from CATE_REPURCHASE_RATE_0201_0410 where CATE_REPURCHASE_RATE > 0;
-- 7

-- SKU master table
drop table if exists SKU_MASTER_0201_0410;
create table SKU_MASTER_0201_0410 as
select
A.*
,B.*
,C.*
from SKU_ACTION_0201_0410 as A
left join
SKU_REPURCHASE_RATE_0201_0410 AS B
ON A.SKU_ID = B.SKU_ID
left join SKU_COMMENT_0201_0410 as C
ON A.SKU_ID = C.SKU_ID
;

select count() from SKU_MASTER_0201_0410;
-- 27907

