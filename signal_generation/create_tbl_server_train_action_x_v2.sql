DROP TABLE IF EXISTS USER_ACTION_0201_0408;
CREATE TABLE USER_ACTION_0201_0408 AS
  SELECT
    USER_ID

    -- 人粒度 signal
    , MAX(AGE) AS AGE
    , MAX(SEX) AS SEX
    , MAX(USER_LV_CD) AS USER_LV_CD
    , MAX(CAST(ROUND((JULIANDAY('2016-04-08') - JULIANDAY(USER_REG_TM))/30) AS INT))           AS USER_REG_M_CNT
    , MAX(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(USER_REG_TM)) <=  5 then 1 else 0  end ) AS USER_REG_05_CNT
    , MAX(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(USER_REG_TM)) <= 10 then 1 else 0  end ) AS USER_REG_10_CNT
    , MAX(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(USER_REG_TM)) <= 15 then 1 else 0  end ) AS USER_REG_15_CNT
    , MAX(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(USER_REG_TM)) <= 20 then 1 else 0  end ) AS USER_REG_20_CNT
    , MAX(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(USER_REG_TM)) <= 25 then 1 else 0  end ) AS USER_REG_25_CNT
    , MAX(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(USER_REG_TM)) <= 45 then 1 else 0  end ) AS USER_REG_30_CNT

    -- 3天内行为 8 和 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8                THEN 1 ELSE 0 END)                AS USER_CATE_8_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_RATE_3
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_1_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_2_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_3_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_4_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_5_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_6_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_1_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_2_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_3_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_4_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_5_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_6_RATE_3
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_02_08_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_CATE_8_HOUR_09_12_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_CATE_8_HOUR_13_18_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_19_01_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_02_08_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_CATE_8_HOUR_09_12_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_CATE_8_HOUR_13_18_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_19_01_RATE_3

    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_CNT_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_RATE_3

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_02_08_SECTION_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_CATE_8_HOUR_09_12_SECTION_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_CATE_8_HOUR_13_18_SECTION_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_19_01_SECTION_3

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_02_08_SECTION_RATE_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_09_12_SECTION_RATE_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_13_18_SECTION_RATE_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_19_01_SECTION_RATE_3

    -- 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8                THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_RATE_3
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_1_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_2_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_3_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_4_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_5_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_6_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_1_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_2_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_3_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_4_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_5_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_6_RATE_3
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_02_08_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_NOT_CATE_8_HOUR_09_12_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_NOT_CATE_8_HOUR_13_18_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_19_01_CNT_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_02_08_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_09_12_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_13_18_RATE_3
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_19_01_RATE_3

    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_CNT_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_RATE_3

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_02_08_SECTION_CNT_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_NOT_CATE_8_HOUR_09_12_SECTION_CNT_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_NOT_CATE_8_HOUR_13_18_SECTION_CNT_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_19_01_SECTION_CNT_3

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_02_08_SECTION_RATE_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_09_12_SECTION_RATE_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_13_18_SECTION_RATE_3
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_19_01_SECTION_RATE_3



    -- 7天内行为 8 和 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8                THEN 1 ELSE 0 END)                AS USER_CATE_8_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_RATE_7
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_1_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_2_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_3_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_4_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_5_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_6_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_1_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_2_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_3_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_4_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_5_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_6_RATE_7
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_02_08_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_CATE_8_HOUR_09_12_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_CATE_8_HOUR_13_18_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_19_01_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_02_08_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_CATE_8_HOUR_09_12_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_CATE_8_HOUR_13_18_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_19_01_RATE_7
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_00_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_01_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_02_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_03_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_04_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_05_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_06_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_00_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_01_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_02_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_03_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_04_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_05_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_06_RATE_7

    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_RATE_7

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_02_08_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_CATE_8_HOUR_09_12_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_CATE_8_HOUR_13_18_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_19_01_SECTION_CNT_7

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_02_08_SECTION_RATE_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_09_12_SECTION_RATE_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_13_18_SECTION_RATE_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_19_01_SECTION_RATE_7
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_RATE_7



    -- 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8                THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_RATE_7
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_1_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_2_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_3_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_4_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_5_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_6_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_1_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_2_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_3_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_4_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_5_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_6_RATE_7
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_02_08_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_NOT_CATE_8_HOUR_09_12_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_NOT_CATE_8_HOUR_13_18_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_19_01_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_02_08_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_09_12_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_13_18_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_19_01_RATE_7
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_00_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_01_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_02_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_03_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_04_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_05_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_06_CNT_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_00_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_01_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_02_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_03_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_04_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_05_RATE_7
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_06_RATE_7
    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_RATE_7

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_02_08_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_NOT_CATE_8_HOUR_09_12_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_NOT_CATE_8_HOUR_13_18_SECTION_CNT_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_19_01_SECTION_CNT_7

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_02_08_SECTION_RATE_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_09_12_SECTION_RATE_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_13_18_SECTION_RATE_7
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_19_01_SECTION_RATE_7
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_CNT_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_RATE_7
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 7) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_RATE_7



    -- 15天内行为 8 和 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8                THEN 1 ELSE 0 END)                AS USER_CATE_8_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_RATE_15
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_1_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_2_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_3_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_4_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_5_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_6_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_1_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_2_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_3_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_4_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_5_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_6_RATE_15
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_02_08_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_CATE_8_HOUR_09_12_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_CATE_8_HOUR_13_18_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_19_01_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_02_08_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_CATE_8_HOUR_09_12_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_CATE_8_HOUR_13_18_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_19_01_RATE_15
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_00_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_01_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_02_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_03_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_04_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_05_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_06_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_00_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_01_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_02_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_03_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_04_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_05_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_06_RATE_15

    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_RATE_15

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_02_08_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_CATE_8_HOUR_09_12_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_CATE_8_HOUR_13_18_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_19_01_SECTION_CNT_15

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_02_08_SECTION_RATE_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_09_12_SECTION_RATE_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_13_18_SECTION_RATE_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_19_01_SECTION_RATE_15
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_RATE_15



    -- 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8                THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_RATE_15
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_1_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_2_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_3_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_4_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_5_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_6_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_1_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_2_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_3_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_4_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_5_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_6_RATE_15
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_02_08_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_NOT_CATE_8_HOUR_09_12_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_NOT_CATE_8_HOUR_13_18_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_19_01_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_02_08_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_09_12_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_13_18_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_19_01_RATE_15
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_00_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_01_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_02_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_03_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_04_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_05_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_06_CNT_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_00_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_01_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_02_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_03_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_04_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_05_RATE_15
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_06_RATE_15
    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_RATE_15

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_02_08_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_NOT_CATE_8_HOUR_09_12_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_NOT_CATE_8_HOUR_13_18_SECTION_CNT_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_19_01_SECTION_CNT_15

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_02_08_SECTION_RATE_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_09_12_SECTION_RATE_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_13_18_SECTION_RATE_15
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_19_01_SECTION_RATE_15
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_CNT_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_RATE_15
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 15) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_RATE_15


    -- 30天内行为 8 和 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8                THEN 1 ELSE 0 END)                AS USER_CATE_8_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_RATE_30
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_1_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_2_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_3_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_4_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_5_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_6_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_1_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_2_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_3_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_4_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_5_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_6_RATE_30
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_02_08_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_CATE_8_HOUR_09_12_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_CATE_8_HOUR_13_18_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_19_01_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_02_08_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_CATE_8_HOUR_09_12_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_CATE_8_HOUR_13_18_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_19_01_RATE_30
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_00_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_01_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_02_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_03_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_04_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_05_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_06_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_00_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_01_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_02_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_03_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_04_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_05_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_06_RATE_30

    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_RATE_30

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_02_08_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_CATE_8_HOUR_09_12_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_CATE_8_HOUR_13_18_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_19_01_SECTION_CNT_30

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_02_08_SECTION_RATE_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_09_12_SECTION_RATE_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_13_18_SECTION_RATE_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_19_01_SECTION_RATE_30
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_RATE_30



    -- 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8                THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_RATE_30
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_1_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_2_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_3_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_4_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_5_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_6_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_1_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_2_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_3_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_4_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_5_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_6_RATE_30
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_02_08_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_NOT_CATE_8_HOUR_09_12_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_NOT_CATE_8_HOUR_13_18_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_19_01_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_02_08_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_09_12_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_13_18_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_19_01_RATE_30
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_00_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_01_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_02_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_03_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_04_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_05_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_06_CNT_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_00_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_01_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_02_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_03_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_04_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_05_RATE_30
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_06_RATE_30
    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_RATE_30

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_02_08_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_NOT_CATE_8_HOUR_09_12_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_NOT_CATE_8_HOUR_13_18_SECTION_CNT_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_19_01_SECTION_CNT_30

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_02_08_SECTION_RATE_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_09_12_SECTION_RATE_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_13_18_SECTION_RATE_30
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_19_01_SECTION_RATE_30
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_CNT_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_RATE_30
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 30) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_RATE_30


    -- 45 8 和 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8                THEN 1 ELSE 0 END)                AS USER_CATE_8_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_RATE_45
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_1_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_2_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_3_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_4_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_5_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_6_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_1_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_2_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_3_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_4_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_5_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_6_RATE_45
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_02_08_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_CATE_8_HOUR_09_12_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_CATE_8_HOUR_13_18_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_19_01_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_02_08_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_CATE_8_HOUR_09_12_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_CATE_8_HOUR_13_18_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_19_01_RATE_45
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_00_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_01_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_02_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_03_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_04_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_05_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_06_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_00_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_01_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_02_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_03_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_04_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_05_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_06_RATE_45

    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_RATE_45

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_02_08_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_CATE_8_HOUR_09_12_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_CATE_8_HOUR_13_18_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_19_01_SECTION_CNT_45

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_02_08_SECTION_RATE_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_09_12_SECTION_RATE_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_13_18_SECTION_RATE_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_19_01_SECTION_RATE_45
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_RATE_45



    -- 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8                THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_RATE_45
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_1_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_2_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_3_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_4_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_5_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_6_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_1_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_2_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_3_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_4_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_5_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_6_RATE_45
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_02_08_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_NOT_CATE_8_HOUR_09_12_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_NOT_CATE_8_HOUR_13_18_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_19_01_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_02_08_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_09_12_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_13_18_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_19_01_RATE_45
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_00_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_01_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_02_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_03_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_04_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_05_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_06_CNT_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_00_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_01_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_02_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_03_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_04_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_05_RATE_45
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_06_RATE_45
    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_RATE_45

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_02_08_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_NOT_CATE_8_HOUR_09_12_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_NOT_CATE_8_HOUR_13_18_SECTION_CNT_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_19_01_SECTION_CNT_45

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_02_08_SECTION_RATE_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_09_12_SECTION_RATE_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_13_18_SECTION_RATE_45
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_19_01_SECTION_RATE_45
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_CNT_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_RATE_45
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 45) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_RATE_45

    -- 60天内行为 8 和 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8                THEN 1 ELSE 0 END)                AS USER_CATE_8_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_RATE_60
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_1_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_2_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_3_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_4_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_5_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_CATE_8_TYPE_6_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_1_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_2_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_3_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_4_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_5_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_CATE_8_TYPE_6_RATE_60
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_02_08_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_CATE_8_HOUR_09_12_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_CATE_8_HOUR_13_18_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_CATE_8_HOUR_19_01_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_02_08_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_CATE_8_HOUR_09_12_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_CATE_8_HOUR_13_18_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_CATE_8_HOUR_19_01_RATE_60
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_00_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_01_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_02_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_03_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_04_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_05_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_CATE_8_WEEK_06_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_00_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_01_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_02_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_03_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_04_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_05_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_CATE_8_WEEK_06_RATE_60

    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))       AS USER_CATE_8_SECTION_RATE_60

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_02_08_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_CATE_8_HOUR_09_12_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_CATE_8_HOUR_13_18_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_CATE_8_HOUR_19_01_SECTION_CNT_60

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_02_08_SECTION_RATE_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_09_12_SECTION_RATE_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_13_18_SECTION_RATE_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY = 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))  AS USER_CATE_8_HOUR_19_01_SECTION_RATE_60
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_00_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_01_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_02_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_03_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_04_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_05_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY = 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_CATE_8_WEEK_06_SECTION_RATE_60



    -- 非8
    ---- over all action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8                THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8                THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_RATE_60
    ---- type action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_1_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_2_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_3_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_4_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_5_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END)                AS USER_NOT_CATE_8_TYPE_6_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "1" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_1_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "2" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_2_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "3" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_3_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "4" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_4_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "5" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_5_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and TYPE = "6" THEN 1 ELSE 0 END) *1.0 / COUNT() AS USER_NOT_CATE_8_TYPE_6_RATE_60
    ---- hour action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_02_08_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                                   AS USER_NOT_CATE_8_HOUR_09_12_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)                       AS USER_NOT_CATE_8_HOUR_13_18_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END)                 AS USER_NOT_CATE_8_HOUR_19_01_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('02', '03', '04', '05', '06', '07', '08' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_02_08_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('09', '10', '11', '12' ) THEN 1 ELSE 0 END)                   *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_09_12_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('13', '14', '15', '16', '17', '18' ) THEN 1 ELSE 0 END)       *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_13_18_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%H', TIME) in ('19', '20', '21', '22', '23', '00', '01' ) THEN 1 ELSE 0 END) *1.0 / COUNT()  AS USER_NOT_CATE_8_HOUR_19_01_RATE_60
    ---- week action level
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_00_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_01_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_02_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_03_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_04_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_05_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END) AS USER_NOT_CATE_8_WEEK_06_CNT_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_00_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_01_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_02_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_03_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_04_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_05_RATE_60
    , SUM(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN 1 ELSE 0 END)*1.0 / COUNT() AS USER_NOT_CATE_8_WEEK_06_RATE_60
    ---- OVER ALL SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 THEN SESSION_ID ELSE NULL END)) *1.0/COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))       AS USER_NOT_CATE_8_SECTION_RATE_60

    ---- HOUR SECTION LEVEL
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_02_08_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                                   AS USER_NOT_CATE_8_HOUR_09_12_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))                       AS USER_NOT_CATE_8_HOUR_13_18_SECTION_CNT_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END))                 AS USER_NOT_CATE_8_HOUR_19_01_SECTION_CNT_60

    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('02', '03', '04', '05', '06', '07', '08' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_02_08_SECTION_RATE_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('09', '10', '11', '12' )  THEN SESSION_ID ELSE NULL END))                   *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_09_12_SECTION_RATE_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('13', '14', '15', '16', '17', '18' )  THEN SESSION_ID ELSE NULL END))       *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_13_18_SECTION_RATE_60
    , COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) AND CATEGORY != 8 AND STRFTIME('%H', TIME) IN ('19', '20', '21', '22', '23', '00', '01' )  THEN SESSION_ID ELSE NULL END)) *1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 3) THEN SESSION_ID ELSE NULL END))  AS USER_NOT_CATE_8_HOUR_19_01_SECTION_RATE_60
    ---- week SECTION LEVEL
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_CNT_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '0' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_00_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '1' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_01_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '2' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_02_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '3' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_03_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '4' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_04_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '5' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_05_SECTION_RATE_60
    , count(distinct(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) and CATEGORY != 8 and STRFTIME('%w', TIME) =  '6' THEN SESSION_ID ELSE NULL END))*1.0 / COUNT(DISTINCT(CASE WHEN (JULIANDAY('2016-04-08') - JULIANDAY(TIME) <= 60) THEN SESSION_ID ELSE NULL END)) AS USER_NOT_CATE_8_WEEK_06_SECTION_RATE_60


  FROM JDATA_ALL_TBL
  Where
    1=1
    AND TIME >= DATE('2016-02-01')
    AND TIME <= DATE('2016-04-08')
  GROUP BY
    USER_ID
;
SELECT COUNT() FROM USER_ACTION_0201_0408;
-- 103431



